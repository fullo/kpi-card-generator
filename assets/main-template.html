<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>{{TITOLO_ESERCIZIO}}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #e5e7eb; }
        .page-container { max-width: 7xl; margin: auto; padding: 2rem; }
        .playing-card { font-family: 'Inter', sans-serif; background: #f3f4f6; border: 1px solid #9ca3af; border-radius: 1rem; width: 300px; height: 420px; padding: 0.75rem; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); display: flex; flex-direction: column; page-break-inside: avoid; position: relative; }
        .playing-card .inner-frame { border: 3px solid #d1d5db; border-radius: 0.75rem; height: 100%; display: flex; flex-direction: column; padding: 0.75rem; background-color: #ffffff; }
        .card-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 0.5rem; border-bottom: 2px solid #e5e7eb; }
        .card-title { font-family: 'Roboto Slab', serif; font-size: 0.95rem; font-weight: 700; border-radius: 0.25rem; padding: 0 0.25rem; }
        .card-icon-container { width: 32px; height: 32px; border-radius: 9999px; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; }
        .card-image-area { height: 90px; background-color: #e5e7eb; margin-top: 0.75rem; border-radius: 0.5rem; display: flex; justify-content: center; align-items: center; font-size: 4rem; }
        .card-type-banner { margin-top: 0.75rem; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: white; align-self: flex-start; }
        .card-description-box { margin-top: 0.5rem; padding: 0.75rem; background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 0.5rem; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .card-description-box .main-text { font-size: 0.9rem; line-height: 1.4; }
        .card-flavor-text { font-size: 0.75rem; font-style: italic; color: #4b5563; margin-top: 0.35rem; padding-top: 0.35rem; border-top: 1px dashed #d1d5db; }
        .card-back { display: flex; flex-direction: column; justify-content: space-between; align-items: center; height: 100%; text-align: center; }
        .card-back .back-icon { font-size: 8rem; margin-top: 4rem; }
        .card-back .back-credit { font-size: 0.6rem; color: #6b7280; align-self: flex-end; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem; justify-items: center; }
        .section-title { font-size: 2.25rem; font-weight: 700; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #d1d5db; text-align: center; }
        .section-subtitle { font-size: 1.125rem; color: #4b5563; margin-bottom: 2.5rem; text-align: center; }
        .print-instructions { background-color: #fefce8; border: 2px dashed #facc15; padding: 1.5rem; margin: 3rem 0; text-align: center; font-weight: 600; color: #ca8a04; }
        .spiegazione .card-image-area { display: none; }
        .spiegazione .main-text { font-size: 0.75rem; line-height: 1.2; }
        .spiegazione .card-type-banner { background-color: black; }
        .card-evento-tecnico .card-title, .card-evento-tecnico .card-type-banner { background-color: #3b82f6; color: white; } .card-evento-tecnico .card-icon-container { background-color: #dbeafe; color: #3b82f6; }
        .card-evento-marketing .card-title, .card-evento-marketing .card-type-banner { background-color: #ec4899; color: white; } .card-evento-marketing .card-icon-container { background-color: #fce7f3; color: #ec4899; }
        .card-evento-sales .card-title, .card-evento-sales .card-type-banner { background-color: #14b8a6; color: white; } .card-evento-sales .card-icon-container { background-color: #ccfbf1; color: #14b8a6; }
        .card-evento-aziendale .card-title, .card-evento-aziendale .card-type-banner { background-color: #d97706; color: white; } .card-evento-aziendale .card-icon-container { background-color: #fef3c7; color: #d97706; }
        .card-obiettivo .card-title, .card-obiettivo .card-type-banner { background-color: #10b981; color: white; } .card-obiettivo .card-icon-container { background-color: #d1fae5; color: #10b981; }
        .card-kpi .card-title, .card-kpi .card-type-banner { background-color: #8b5cf6; color: white; } .card-kpi .card-icon-container { background-color: #ede9fe; color: #8b5cf6; }
        .spiegazione .card-title, .spiegazione .card-type-banner { background-color: #0891b2; color: white; } .spiegazione .card-icon-container { background-color: #cffafe; color: #0891b2; }
        
        /* PRINT STYLES */
        @media print {
            @page {
                size: A4 landscape;
                margin: 10mm;
            }

            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                background-color: white;
            }

            .no-print { display: none; }
            .page-container { padding: 0; }
            .section-title, .section-subtitle { display: none; }
            
            /* FIX: Interruzione di pagina robusta */
            .fronts-container {
                page-break-after: always;
            }
            .print-instructions { display: none; }


            .card-grid {
                display: grid;
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 5mm;
                align-items: start;
            }

            .playing-card {
                box-shadow: none;
                border: 1px dashed #9ca3af;
                width: 65mm;
                height: 91mm;
                padding: 0.25rem;
            }

            /* FIX: Ruota tutte le carte del retro */
            .backs-container .playing-card {
                transform: rotate(180deg);
            }
            
            .playing-card.placeholder {
                border: none;
                background: transparent;
            }

            .playing-card .inner-frame {
                padding: 0.3rem;
                border-width: 2px;
            }

            .card-header {
                padding-bottom: 0.25rem;
            }

            .card-title {
                font-size: 0.7rem;
                padding: 0.1rem 0.2rem;
            }
            
            .card-icon-container {
                width: 20px;
                height: 20px;
                font-size: 0.9rem;
            }

            .card-image-area {
                height: 45px;
                margin-top: 0.25rem;
                font-size: 2rem;
            }

            .card-type-banner {
                margin-top: 0.25rem;
                font-size: 0.6rem;
                padding: 0.1rem 0.3rem;
            }

            .card-description-box {
                margin-top: 0.25rem;
                padding: 0.4rem;
            }

            .card-description-box .main-text {
                font-size: 0.65rem;
                line-height: 1.3;
            }

            .card-flavor-text {
                font-size: 0.6rem;
                margin-top: 0.25rem;
                padding-top: 0.25rem;
            }

            .card-back .back-icon {
                font-size: 4rem;
                margin-top: 2rem;
            }

            .card-back .back-credit {
                font-size: 0.5rem;
            }
            
            .spiegazione .card-image-area { display: none; }
            .spiegazione .main-text { font-size: 0.7rem; line-height: 1.2; }

            .card-conflitto .card-description-box { padding: 0.4rem; }
            .card-conflitto .card-description-box .main-text { font-size: 0.65rem; line-height: 1.3; }
            .card-conflitto .card-description-box h4 { font-size: 0.8rem; margin-bottom: 0.15rem; }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="text-center mb-12 no-print">
            <h1 class="text-4xl font-bold text-gray-800">{{TITOLO_ESERCIZIO}}</h1>
            <p class="mt-4 text-lg text-gray-600">{{SOTTOTITOLO_ESERCIZIO}}</p>
        </div>
        <div class="fronts-container">
            <h2 class="section-title">Fronte Carte</h2>
            <div class="card-grid">{{FRONTE_CARTE}}</div>
        </div>
        <div class="print-instructions no-print">ATTENZIONE: Stampa fino a questa pagina, poi reinserisci i fogli per stampare il retro.</div>
        <div class="backs-container">
            <h2 class="section-title">Retro Carte</h2>
            <div class="card-grid">{{RETRO_CARTE}}</div>
        </div>
    </div>
</body>
</html>
